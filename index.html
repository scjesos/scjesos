<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>행사장 지도 — 화살표 작동 수정본</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f9f9f9;
    height: 100vh;
    overflow: hidden;
  }

  /* 지도 전체 스크롤/확대용 컨테이너 */
  .zoom-wrapper {
    width: 100%;
    height: 100%;
    overflow: auto;
    touch-action: pan-x pan-y pinch-zoom;
  }

  .map-container {
    position: relative;
    width: 200%;
    height: auto;
  }

  .map-container img { width: 100%; height: auto; display: block; }

  .hotspot { position: absolute; cursor: pointer; }

  /* 팝업 오버레이 (항상 화면 기준) */
  .popup {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.7);
    display: flex; align-items: center; justify-content: center;
    z-index: 9999;
  }

  .popup-content {
    position: relative;
    background: #fff;
    padding: 18px 16px;
    border-radius: 12px;
    width: 420px;
    max-width: 92%;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    text-align: center;
    overflow: visible; /* 화살표가 잘리지 않도록 */
  }

  /* 이미지: 팝업 내부에서만 크기 고정 (팝업 외부의 줌 영향 없음) */
  .popup-content img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 8px;
    user-select: none;
    pointer-events: none; /* 이미지 자체는 클릭 차단 */
  }

  .popup-content p { margin: 12px 0 0; font-size: 14px; color:#222; }

  .close-btn {
    display:inline-block;
    margin-top:12px;
    padding:8px 14px;
    background:#333; color:#fff; border:none; border-radius:6px;
    cursor:pointer;
  }

  /* 화살표 버튼 (팝업 콘텐츠 내부에 배치) */
  .arrow-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 38px; height: 38px;
    border-radius: 50%;
    border: none;
    background: rgba(0,0,0,0.06);
    cursor: pointer;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .arrow-btn:active { transform: translateY(-50%) scale(0.98); }

  .arrow-left { left: -18px; } /* 내부에 보이도록 작게 옮김 */
  .arrow-right { right: -18px; }

  .arrow-btn[disabled] {
    opacity: 0.35;
    cursor: not-allowed;
  }

  /* 안내 팝업용 스타일 (별도) */
  .intro-title { font-size: 16px; margin: 0 0 8px; }
  .intro-text { font-size: 13px; color:#333; line-height:1.4; margin:0; }
</style>
</head>
<body>

<div class="zoom-wrapper">
  <div class="map-container">
    <img src="map.png" alt="행사장 지도">

    <div class="hotspot" data-name="콩이관" style="top:25.4%; left:30.8%; width:6%; height:6%;"></div>
    <div class="hotspot" data-name="홍메관" style="top:53.8%; left:45.7%; width:4%; height:10%;"></div>
    <div class="hotspot" data-name="다년생 식물원" style="top:35%; left:29.3%; width:4.5%; height:8%;"></div>
    <div class="hotspot" data-name="효모관" style="top:46%; left:40%; width:4%; height:10%;"></div>
    <div class="hotspot" data-name="콩이공원" style="top:58.5%; left:86.3%; width:5%; height:7%;"></div>
    <div class="hotspot" data-name="팡이공원" style="top:56.8%; left:69.5%; width:5%; height:7%;"></div>
    <div class="hotspot" data-name="팡이관" style="top:57.3%; left:40%; width:4%; height:8.5%;"></div>
  </div>
</div>

<script>
const images = {
  "콩이관": ["콩이관1.jpg","콩이관2.jpg","콩이관3.jpg","콩이관4.jpg"],
  "홍메관": ["홍메관1.jpg","홍메관2.jpg","홍메관3.jpg"],
  "다년생 식물원": ["다년생식물원1.jpg","다년생식물원2.jpg","다년생식물원3.jpg"],
  "효모관": ["효모관1.jpg","효모관2.jpg","효모관3.jpg"],
  "콩이공원": ["콩이공원1.jpg"],
  "팡이공원": ["팡이공원1.jpg","팡이공원2.jpg"],
  "팡이관": ["팡이관1.jpg"]
};

const descs = {
  "콩이관": [
    "콩이관 입구: 장애인 전용 길 배치",
    "실내에 장애인 전용 화장실 배치",
    "실내에 장애인 전용 엘리베이터 배치",
    "실내 내부 모습: 지체 장애인을 위한 휠체어가 구비되어 있으며 지체 장애인 모두 시설 이용가능"
  ],
  "홍메관": [
    "(위 건물이 테라포밍관) 테라포밍관은 놀이기구 이용이 어려울 수 있음",
    "출입구 휠체어로 이용 가능",
    "출입구 입장 후 좌측에 장애인 전용 화장실"
  ],
  "다년생 식물원": [
    "수목원 내부에 엘리베이터가 설치되어 있어 휠체어로 통행이 편하다",
    "수목원 내부 1층 왼쪽에 장애인 화장실이 마련되어 있다",
    "수목원 내부에 1층 왼쪽에 장애인 화장실이 마련되어 있다"
  ],
  "효모관": [
    "고정문 옆 점자 안내도",
    "입장 후 왼쪽 엘리베이터 설치",
    "고정문 후 자동문 있음"
  ],
  "콩이공원": [
    "공원 안쪽 길이 포장되어 있지 않아서 비가 오면 땅이 질퍽해져 이동하기 불편함"
  ],
  "팡이공원": [
    "길이 좁고 울퉁불퉁해서 휠체어를 타고 올라가기 어려움",
    "펜스가 없는 부분이 있어 위험함"
  ],
  "팡이관": [
    "1번 출입구 입장 후 오른쪽에 엘리베이터"
  ]
};

function showPopup(name) {
  let idx = 0;

  // 팝업 구조를 DOM API로 생성 (내부 요소 참조가 명확)
  const popup = document.createElement('div');
  popup.className = 'popup';

  const content = document.createElement('div');
  content.className = 'popup-content';

  const imgEl = document.createElement('img');
  imgEl.src = images[name][idx];
  imgEl.alt = name;

  const textEl = document.createElement('p');
  textEl.textContent = descs[name][idx];

  const leftBtn = document.createElement('button');
  leftBtn.className = 'arrow-btn arrow-left';
  leftBtn.innerHTML = '&#9664;'; // ◀
  leftBtn.setAttribute('aria-label','이전');

  const rightBtn = document.createElement('button');
  rightBtn.className = 'arrow-btn arrow-right';
  rightBtn.innerHTML = '&#9654;'; // ▶
  rightBtn.setAttribute('aria-label','다음');

  const closeBtn = document.createElement('button');
  closeBtn.className = 'close-btn';
  closeBtn.textContent = '닫기';

  // append order (화살표는 content 내부에 있으므로 클릭 가능)
  content.appendChild(leftBtn);
  content.appendChild(imgEl);
  content.appendChild(rightBtn);
  content.appendChild(textEl);
  content.appendChild(closeBtn);
  popup.appendChild(content);
  document.body.appendChild(popup);

  // 업데이트 함수
  function update() {
    imgEl.src = images[name][idx];
    textEl.textContent = descs[name][idx];
    leftBtn.disabled = (idx === 0);
    rightBtn.disabled = (idx === images[name].length - 1);

    // 시각적 변화 (disabled 스타일은 CSS로 처리)
    if (leftBtn.disabled) leftBtn.classList.add('disabled'); else leftBtn.classList.remove('disabled');
    if (rightBtn.disabled) rightBtn.classList.add('disabled'); else rightBtn.classList.remove('disabled');
  }

  leftBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    if (idx > 0) { idx--; update(); }
  });

  rightBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    if (idx < images[name].length - 1) { idx++; update(); }
  });

  closeBtn.addEventListener('click', () => popup.remove());
  // 오버레이 바깥 클릭으로 닫기
  popup.addEventListener('click', (ev) => { if (ev.target === popup) popup.remove(); });

  update();
}

// 핫스팟 클릭 이벤트 등록
document.querySelectorAll('.hotspot').forEach(h => {
  h.addEventListener('click', () => showPopup(h.dataset.name));
});

// 자동 안내 팝업 (처음 로드 시)
window.addEventListener('load', () => {
  const notice = document.createElement('div');
  notice.className = 'popup';
  notice.innerHTML = `
    <div class="popup-content">
      <h2 class="intro-title">장류마을 테마파크는 BF인증 시설입니다.</h2>
      <p class="intro-text">BF인증은 장애인, 노약자, 임산부 등 사회적 약자가<br>
         시설을 안전하고 편리하게 이용할 수 있도록<br>
         보장하는 제도입니다.</p>
      <button class="close-btn">확인</button>
    </div>
  `;
  document.body.appendChild(notice);
  notice.querySelector('.close-btn').addEventListener('click', () => notice.remove());
});
</script>
</body>
</html>
